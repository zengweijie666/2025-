<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>精彩视频回顾 - 毕业回忆胶囊</title>
    <link rel="stylesheet" href="public/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Noto+Serif+SC:wght@400;600&display=swap"
        rel="stylesheet">
    <meta name="referrer" content="no-referrer">
</head>

<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="public/images/logo.png" alt="Logo" class="nav-logo">
                <span class="site-name">毕业回忆胶囊</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">首页</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="gallery.html">照片墙</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="timeline.html">时光轴</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="blessings.html">祝福留言</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="stories.html">我们的故事</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="videos.html">视频回顾</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">关于我们</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 页面标题 -->
    <div class="page-title-section">
        <div class="container">
            <h1 class="page-title" data-aos="fade-up">精彩视频回顾</h1>
            <p class="page-description" data-aos="fade-up" data-aos-delay="200">记录美好时光，重温青春记忆</p>
        </div>
    </div>

    <!-- 视频列表 -->
    <section class="videos-section">
        <div class="container">
            <div class="videos-container">
                <div class="row" id="dynamic-videos">
                    <!-- 视频内容将从data.js动态加载 -->
                </div>
            </div>

            <!-- 上传视频按钮 -->
            <div class="text-center mt-5" data-aos="fade-up">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addVideoModal">
                    <i class="fas fa-plus me-2"></i>分享我的视频
                </button>
            </div>
        </div>
    </section>

    <!-- 上传视频模态框 -->
    <div class="modal fade" id="addVideoModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">分享视频</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="videoForm">
                        <div class="mb-3">
                            <label for="videoTitle" class="form-label">视频标题 *</label>
                            <input type="text" class="form-control" id="videoTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="videoUrl" class="form-label">视频链接 *</label>
                            <input type="url" class="form-control" id="videoUrl"
                                placeholder="例如：https://www.youtube.com/embed/videoID" required>
                            <small class="form-text text-muted">支持YouTube、Bilibili等平台的嵌入链接</small>
                        </div>
                        <div class="mb-3">
                            <label for="videoCover" class="form-label">封面图片</label>
                            <input type="file" class="form-control" id="videoCover" accept="image/*">
                        </div>
                        <div class="mb-3">
                            <label for="videoDescription" class="form-label">视频描述</label>
                            <textarea class="form-control" id="videoDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="videoCategory" class="form-label">分类</label>
                            <select class="form-select" id="videoCategory">
                                <option value="graduation">毕业典礼</option>
                                <option value="activity">班级活动</option>
                                <option value="daily">日常生活</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="submitVideo">提交</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6">
                    <h3>毕业回忆胶囊</h3>
                    <p>时光不散，青春永驻</p>
                    <p>一个永久保存我们青春回忆的地方</p>
                </div>
                <div class="col-lg-4 col-md-6">
                    <h3>快速链接</h3>
                    <ul class="footer-links">
                        <li><a href="gallery.html">照片墙</a></li>
                        <li><a href="timeline.html">时光轴</a></li>
                        <li><a href="blessings.html">祝福留言</a></li>
                        <li><a href="stories.html">我们的故事</a></li>
                    </ul>
                </div>
                <div class="col-lg-4">
                    <h3>联系我们</h3>
                    <p>有任何问题或建议，请联系网站管理员</p>
                    <p><i class="fas fa-envelope"></i> <span id="admin-email">admin@example.com</span></p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-weixin"></i></a>
                        <a href="#"><i class="fab fa-qq"></i></a>
                        <a href="#"><i class="fab fa-weibo"></i></a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 毕业回忆胶囊 版权所有</p>
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button id="back-to-top" title="返回顶部">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- JavaScript 库 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/js/all.min.js"></script>
    <script src="public/js/data.js"></script>

    <script>
        // 初始化AOS动画
        AOS.init({
            duration: 800,
            once: true
        });

        // 更新页面标题
        document.title = `精彩视频回顾 - ${websiteData.siteTitle || '毕业回忆胶囊'}`;

        // 更新管理员邮箱
        if (websiteData.adminEmail) {
            document.getElementById('admin-email').textContent = websiteData.adminEmail;
        }

        // 渲染视频列表
        function renderVideos() {
            const videosContainer = document.getElementById('dynamic-videos');
            if (!videosContainer || !websiteData.videoData) return;

            // 清空容器
            videosContainer.innerHTML = '';

            // 渲染视频
            websiteData.videoData.forEach(video => {
                const videoCol = document.createElement('div');
                videoCol.className = 'col-lg-4 col-md-6 mb-4';
                videoCol.setAttribute('data-aos', 'fade-up');

                videoCol.innerHTML = `
                    <div class="video-card">
                        <div class="video-embed">
                            <iframe src="${video.videoUrl}" 
                                title="${video.title}" frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                            </iframe>
                        </div>
                        <div class="video-info">
                            <h3 class="video-title">${video.title}</h3>
                            <p class="video-description">${video.description || ''}</p>
                            <div class="video-meta">
                                <span class="video-category">${getCategoryName(video.category)}</span>
                                <span class="video-date">${video.date || ''}</span>
                            </div>
                        </div>
                    </div>
                `;

                videosContainer.appendChild(videoCol);
            });

            // 如果没有视频，显示提示
            if (websiteData.videoData.length === 0) {
                videosContainer.innerHTML = `
                    <div class="col-12 text-center py-5">
                        <p>暂无视频，快来分享你的精彩回忆吧！</p>
                    </div>
                `;
            }
        }

        // 获取分类名称
        function getCategoryName(category) {
            const categories = {
                'graduation': '毕业典礼',
                'activity': '班级活动',
                'daily': '日常生活',
                'other': '其他'
            };
            return categories[category] || '其他';
        }

        // 处理视频提交
        document.getElementById('submitVideo').addEventListener('click', function () {
            const title = document.getElementById('videoTitle').value;
            const videoUrl = document.getElementById('videoUrl').value;
            const description = document.getElementById('videoDescription').value;
            const category = document.getElementById('videoCategory').value;

            if (!title || !videoUrl) {
                alert('请填写必填字段');
                return;
            }

            // 格式化日期为当前日期
            const today = new Date();
            const formattedDate = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;

            // 使用data.js中的辅助函数添加新视频
            websiteData.helpers.addVideo(title, videoUrl, description, category, 'public/images/video-thumbnail.jpg', formattedDate);

            // 重新渲染视频
            renderVideos();

            // 关闭模态框
            const modal = bootstrap.Modal.getInstance(document.getElementById('addVideoModal'));
            modal.hide();

            alert('视频已成功提交！');

            // 清空表单
            document.getElementById('videoForm').reset();
        });

        // 页面加载完成后渲染视频
        document.addEventListener('DOMContentLoaded', function () {
            renderVideos();
        });

        // 返回顶部按钮功能
        const backToTopButton = document.getElementById('back-to-top');
        window.addEventListener('scroll', function () {
            if (window.pageYOffset > 300) {
                backToTopButton.style.display = 'block';
            } else {
                backToTopButton.style.display = 'none';
            }
        });

        backToTopButton.addEventListener('click', function () {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    </script>
</body>

</html>